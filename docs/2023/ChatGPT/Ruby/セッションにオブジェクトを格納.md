# Rubyでsessionにオブジェクトを入れた際に破壊的メソッドを使った際の挙動について教えて。意図しないsessionの値を壊したので

Rubyのセッションにオブジェクトを格納したときに破壊的メソッドを使用すると、セッション内のオブジェクトも変更されます。
これは、Rubyがオブジェクトへの参照をセッションに格納するためです。
セッションに格納されたオブジェクトに対して破壊的メソッド（!で終わるメソッドなど）を使用すると、そのオブジェクト自体が変更され、セッション内のデータも変更されます。

例えば、セッションに配列を格納し、その後で配列に対して array.sort! のような破壊的メソッドを実行すると、セッション内の配列もソートされた状態に変わります。

このような挙動を避けるには、オブジェクトをセッションに格納する前に .dup または .clone メソッドを使用してオブジェクトのコピーを作成すると良いでしょう。
これにより、オリジナルのオブジェクトとは別のオブジェクトがセッションに格納され、オリジナルのオブジェクトに対する変更がセッションのデータに影響しなくなります。

例:

```ruby
original_array = [3, 1, 2]
session[:array] = original_array.dup # オブジェクトのコピーをセッションに格納
original_array.sort! # オリジナルの配列をソート

# セッション内の配列は変更されていない
puts session[:array] # => [3, 1, 2]
```

この方法を使うと、セッション内のデータを意図せず変更するリスクを減らすことができます。`
